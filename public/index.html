<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inua Solutions CRM</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
<div class="container">
    <div class="left-side">
        <h1>Inua Solutions</h1>
        <h2>Access to Goods on Credit for Rural Households</h2>
        <p>At Inua Solutions, we believe in empowering rural communities by providing access to essential goods through flexible credit options. Our innovative platform bridges the gap between rural households and quality products, fostering economic growth and improving living standards.</p>
        <p>Join us in our mission to transform rural economies and create sustainable opportunities for families across the region.</p>
    </div>
    <div class="right-side">
        <div class="tab-container">
            <div class="tab active" onclick="showTab('login')">Login</div>
            <div class="tab" onclick="showTab('register')">Register</div>
        </div>
        <div class="form-container">
            <!-- Login Form -->
            <form id="loginForm">
                <input type="email" id="email" placeholder="Email" required>
                <input type="password" id="password" placeholder="Password" required>
                <button type="submit">Login</button>
                <a href="#" class="forgot-password">Forgot Password?</a>
                <p id="loginError" class="error-message"></p> <!-- Placeholder for login error message -->
            </form>
            <!-- Register Form -->
            <form id="registerForm" style="display:none;">
                <input type="text" placeholder="Username" required>
                <input type="email" placeholder="Email" required>
                <input type="password" placeholder="Password" required>
                <select required>
                    <option value="">Select Role</option>
                    <option value="admin">Admin</option>
                    <option value="group_coordinator">Group Coordinator</option>
                    <option value="sales_manager">Sales Manager</option>
                    <option value="customer_service">Customer Service</option>
                    <option value="management">Management</option>
                </select>
                <button type="submit">Register</button>
            </form>
            <!-- Password Reset Form -->
            <form id="passwordResetForm" style="display:none;">
                <input type="email" id="resetEmail" placeholder="Enter your email" required>
                <button type="submit">Reset Password</button>
                <p id="resetSuccess" class="success-message"></p> <!-- Placeholder for reset success message -->
                <p id="resetError" class="error-message"></p> <!-- Placeholder for reset error message -->
            </form>
        </div>
    </div>
</div>

<script>
    function showTab(tabName) {
        document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
        document.querySelector(`.tab:nth-child(${tabName === 'login' ? '1' : '2'})`).classList.add('active');
        document.getElementById('loginForm').style.display = tabName === 'login' ? 'block' : 'none';
        document.getElementById('registerForm').style.display = tabName === 'register' ? 'block' : 'none';
        document.getElementById('passwordResetForm').style.display = 'none'; // Hide password reset form when switching tabs
    }

    document.querySelector('.forgot-password').addEventListener('click', (e) => {
        e.preventDefault();
        document.getElementById('loginForm').style.display = 'none';
        document.getElementById('registerForm').style.display = 'none';
        document.getElementById('passwordResetForm').style.display = 'block';
    });

    document.getElementById('loginForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        try {
            const response = await fetch('/api/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ email, password })
            });

            if (response.ok) {
                const data = await response.json();
                // Redirect user or show success message
            } else {
                const error = await response.json();
                document.getElementById('loginError').textContent = error.error;
            }
        } catch (error) {
            document.getElementById('loginError').textContent = 'An error occurred. Please try again later.';
            console.error('Error:', error);
        }
    });

    document.getElementById('passwordResetForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const email = document.getElementById('resetEmail').value;

        try {
            const response = await fetch('/api/password-reset', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ email })
            });

            if (response.ok) {
                document.getElementById('resetSuccess').textContent = 'Password reset instructions have been sent to your email.';
                document.getElementById('resetError').textContent = ''; // Clear any previous errors
            } else {
                const error = await response.json();
                document.getElementById('resetError').textContent = error.error;
                document.getElementById('resetSuccess').textContent = ''; // Clear any previous success messages
            }
        } catch (error) {
            document.getElementById('resetError').textContent = 'An error occurred. Please try again later.';
            console.error('Error:', error);
        }
    });
</script>
</body>
</html>
